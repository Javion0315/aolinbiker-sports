<template>
  <section id="hero" ref="rootEl"
    class="aolin-hero relative flex min-h-dvh w-full items-center justify-center overflow-hidden bg-black">
    <!-- Cinematic Video Backgroundï¼ˆåƒè€ƒï¼šé«˜å°æ¯”é»‘ç™½å‹•æ…‹å½±åƒï¼‰ -->
    <div class="aolin-hero-bg absolute inset-0 z-0">
      <!-- æ³¨æ„ï¼šå½±ç‰‡ç‚º placeholderï¼›å¯¦éš›ç´ æå¯æ›¿æ› -->
      <video ref="videoEl" autoplay muted loop playsinline preload="auto"
        class="h-full w-full scale-105 object-cover opacity-70 grayscale"
        style="filter: brightness(0.78) contrast(1.15) grayscale(1)">
        <!-- ä½¿ç”¨æœ¬æ©Ÿå½±ç‰‡ï¼šapp/assets/video/main.mp4 -->
        <source :src="heroVideoSrc" type="video/mp4" />
        <!-- fallback placeholderï¼ˆæœ¬æ©Ÿå½±ç‰‡è¼‰å…¥å¤±æ•—æ™‚ï¼‰ -->
        <source src="https://videos.pexels.com/video-files/5192138/5192138-uhd_2560_1440_25fps.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <!-- é»‘è‰²é®ç½©ï¼šå†é™ä½ä¸é€æ˜åº¦ï¼Œè®“å½±ç‰‡æ›´æ¸…æ¥š -->
      <div class="absolute inset-0 z-10 bg-gradient-to-b from-black/30 via-transparent to-black/40" />
    </div>

    <!-- Dynamic Four-Color Flaresï¼ˆå‹•ç•«å¯ç”¨ CSS/GSAPï¼›æ­¤è™•ä¿ç•™ class èˆ‡è¨»è§£ï¼‰ -->
    <div class="pointer-events-none absolute inset-0 z-10 opacity-30 mix-blend-screen">
      <!-- TODO(animation): scale/opacity å¾ªç’°ï¼ˆé€Ÿåº¦æ„Ÿ/ç†±è¡€æ„Ÿï¼‰ -->
      <div
        class="aolin-flare-anim-1 absolute -left-1/4 -top-1/4 h-full w-full rounded-full bg-emerald-600/40 blur-[150px]" />
      <div
        class="aolin-flare-anim-2 absolute -right-1/4 -top-1/4 h-full w-full rounded-full bg-red-600/40 blur-[150px]" />
      <!-- å¯é¸ï¼šé»ƒè‰²/è—è‰² flareï¼ˆå…ˆä¿ç•™çµæ§‹ï¼‰ -->
      <div class="absolute -bottom-1/3 -left-1/3 h-full w-full rounded-full bg-yellow-500/25 blur-[170px]" />
      <div class="absolute -bottom-1/3 -right-1/3 h-full w-full rounded-full bg-blue-600/25 blur-[170px]" />
    </div>

    <div class="relative z-20 mx-auto w-full max-w-7xl px-4 text-center sm:px-6">
      <!-- Team Indicators -->
      <div class="aolin-hero-bars mb-8 flex justify-center gap-3">
        <!-- TODO(animation): scaleX 0->1ï¼ˆä¾åºå‡ºç¾ï¼‰ -->
        <span class="aolin-hero-bar aolin-hero-bar-1 h-1.5 w-12 bg-emerald-600 shadow-[0_0_15px_rgba(34,197,94,0.5)]" />
        <span class="aolin-hero-bar aolin-hero-bar-2 h-1.5 w-12 bg-red-600 shadow-[0_0_15px_rgba(239,68,68,0.5)]" />
        <span class="aolin-hero-bar aolin-hero-bar-3 h-1.5 w-12 bg-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.5)]" />
        <span class="aolin-hero-bar aolin-hero-bar-4 h-1.5 w-12 bg-blue-600 shadow-[0_0_15px_rgba(37,99,235,0.5)]" />
      </div>

      <!-- Titleï¼ˆOverflow hidden + ç”±ä¸‹å¾€ä¸Šæ¨å…¥ï¼‰ -->
      <h1 class="mb-8 mt-4 font-black italic leading-[1.2] tracking-tight text-white drop-shadow-2xl">
        <span class="block text-[9vw] md:text-[6vw]">
          <!-- TODO(animation): y: 100% -> 0 -->
          <span class="aolin-hero-line aolin-hero-line-1 block">åœ˜éšŠæŒ‘æˆ° Ã— ä¸€æ•´å¹´ğŸ”¥</span>
        </span>
        <span class="block text-[9vw] md:text-[6vw]">
          <!-- TODO(animation): y: 100% -> 0 -->
          <span class="aolin-hero-line aolin-hero-line-2 block aolin-text-stroke">ç”¨æ±—æ°´ç´¯ç©æ¦®è€€</span>
        </span>
        <span class="block text-[9vw] md:text-[6vw]">
          <!-- TODO(animation): y: 100% -> 0 -->
          <span class="aolin-hero-line aolin-hero-line-3 block text-red-600">å‚²è‡¨å½¼å®¢é‹å‹•æœƒ</span>
        </span>
      </h1>

      <div class="aolin-hero-cta flex flex-col items-center gap-10">
        <p
          class="border border-white/10 bg-black/40 px-6 py-2 text-[10px] font-bold uppercase tracking-[0.4em] text-white backdrop-blur-sm sm:text-xs md:text-sm">
          <span class="font-black text-emerald-400 drop-shadow-[0_0_6px_#059669bb]">ç¶ </span>
          <span class="font-black text-white mx-1">â€§</span>
          <span class="font-black text-red-500 drop-shadow-[0_0_6px_#ef4444bb]">ç´…</span>
          <span class="font-black text-white mx-1">â€§</span>
          <span class="font-black text-yellow-400 drop-shadow-[0_0_6px_#facc15bb]">é»ƒ</span>
          <span class="font-black text-white mx-1">â€§</span>
          <span class="font-black text-blue-400 drop-shadow-[0_0_6px_#60a5fabb]">è—</span>
          <span class="font-black text-white mx-2">|</span>
          <span class="font-black text-white drop-shadow-[0_0_4px_#fff]">å››å¤§å‹¢åŠ›å³å°‡å¼•çˆ†</span>
        </p>

        <div class="flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-center">
          <a href="#cta"
            class="bg-white px-10 py-4 text-2xl font-black italic text-black shadow-2xl transition-all hover:bg-red-600 hover:text-white [transform:skewX(-12deg)] sm:px-16 sm:py-5 sm:text-3xl">
            <span class="inline-block [transform:skewX(12deg)]">JOIN NOW</span>
          </a>

          <a href="#highlights"
            class="group inline-flex items-center gap-4 text-sm font-bold tracking-widest text-white transition-colors hover:text-red-500">
            <span
              class="flex h-14 w-14 items-center justify-center rounded-full border border-white/20 transition-all group-hover:border-red-600">
              <svg class="h-6 w-6 fill-current" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M8 5v14l11-7z" />
              </svg>
            </span>
            WATCH HIGHLIGHTS
          </a>
        </div>
      </div>
    </div>

    <div class="absolute bottom-0 left-0 z-25 h-32 w-full bg-gradient-to-t from-black to-transparent" />
  </section>
</template>

<script setup lang="ts">
// Hero Sectionï¼šå‹•ç•«éœ€åœ¨é€²å…¥å¯è¦–ç¯„åœæ™‚é‡æ–°é–‹å§‹ï¼ˆIntersectionObserver + class è§¸ç™¼ï¼‰
import { onBeforeUnmount, onMounted, ref } from 'vue'

// ä½¿ç”¨ import è®“ Nuxt/Vite åœ¨ SSR/é‡æ•´æ™‚éƒ½èƒ½ç”¢å‡ºæ­£ç¢ºçš„è³‡ç”¢ URLï¼ˆé¿å… file:// æˆ– 404ï¼‰
import heroVideoSrc from '~/assets/video/main.mp4'

const videoEl = ref<HTMLVideoElement | null>(null)
const rootEl = ref<HTMLElement | null>(null)
let io: IntersectionObserver | null = null

onMounted(() => {
  // æœ‰äº›ç€è¦½å™¨åœ¨é‡æ•´å¾Œä»å¯èƒ½å»¶é² autoplayï¼Œè£œä¸€å€‹ä¿éšª play()
  const v = videoEl.value
  if (!v) return
  v.muted = true
  v.load()
  const tryPlay = () => v.play().catch(() => void 0)
  tryPlay()
  v.addEventListener('canplay', tryPlay, { once: true })

  const reduce = window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches ?? false
  if (reduce) {
    rootEl.value?.classList.add('aolin-hero--in')
    return
  }

  const restart = () => {
    const el = rootEl.value
    if (!el) return
    el.classList.remove('aolin-hero--in')
    void el.offsetWidth
    el.classList.add('aolin-hero--in')
  }

  io = new IntersectionObserver(
    (entries) => {
      const e = entries[0]
      if (!e) return
      if (e.isIntersecting) restart()
    },
    { threshold: 0.35 }
  )

  if (rootEl.value) io.observe(rootEl.value)
})
onBeforeUnmount(() => {
  io?.disconnect()
  io = null
})
</script>
